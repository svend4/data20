# üîç –û—Ç—á–µ—Ç: –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ Phase 7.3

## –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ mobile-app –ø–æ—Å–ª–µ —Ñ–∞–∑—ã 7.3

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞**: 2026-01-05
**–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π –ø–µ—Ä–∏–æ–¥**: –ü–æ—Å–ª–µ commit 324dd58 (Phase 7.3)

---

## üìä –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

### –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞
–ú–µ–∂–¥—É –¥–≤—É–º—è –∫–ª—é—á–µ–≤—ã–º–∏ –∫–æ–º–º–∏—Ç–∞–º–∏ Phase 7.3 –ø—Ä–æ–∏–∑–æ—à–ª–∏ **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | ca458ea (FULL IMPLEMENTATION) | 324dd58 (READY FOR APK) |
|----------|------------------------------|--------------------------|
| –§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ | - | 67 |
| –°—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ | - | +55,424 |
| –°—Ç—Ä–æ–∫ —É–¥–∞–ª–µ–Ω–æ | - | -172 |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | –ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è –≤ backend_main.py | –ú–æ–¥—É–ª—å–Ω–∞—è (mobile_server + –º–æ–¥—É–ª–∏) |

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 1. –§–∞–π–ª backend_main.py - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### ‚ùå –£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–º–æ–≥–ª–∏ –±—ã—Ç—å –ø–æ—Ç–µ—Ä—è–Ω—ã):

**1.1. `create_mobile_app()` —Ñ—É–Ω–∫—Ü–∏—è**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–†–∞–∑–º–µ—Ä**: ~80 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **–ß—Ç–æ –¥–µ–ª–∞–ª–∞**:
  - –°–æ–∑–¥–∞–≤–∞–ª–∞ FastAPI app —Å CORS middleware
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–ª–∞ health check endpoint (`/health`)
  - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–ª–∞ root endpoint (`/`)
  - –ü—ã—Ç–∞–ª–∞—Å—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–æ—É—Ç–µ—Ä—ã –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±—ç–∫–µ–Ω–¥–∞
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```python
# –ë—ã–ª–æ –≤ ca458ea:
def create_mobile_app():
    mobile_app = FastAPI(
        title="Data20 Mobile Backend",
        description="Embedded FastAPI backend for mobile app",
        version="1.0.0",
        docs_url="/docs",
        redoc_url="/redoc"
    )

    mobile_app.add_middleware(
        CORSMiddleware,
        allow_origins=["*"],
        allow_credentials=True,
        allow_methods=["*"],
        allow_headers=["*"],
    )

    @mobile_app.get("/health")
    async def health_check():
        return {
            "status": "ok",
            "environment": "mobile",
            "database": database_path,
            "version": "1.0.0"
        }

    @mobile_app.get("/")
    async def root():
        return {
            "message": "Data20 Mobile Backend",
            "status": "running",
            "docs": "/docs"
        }

    return mobile_app

# –°—Ç–∞–ª–æ –≤ 324dd58:
# –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞, –≤–º–µ—Å—Ç–æ –Ω–µ–µ –∏–º–ø–æ—Ä—Ç:
from mobile_server import app as mobile_app
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —É–¥–∞–ª–µ–Ω–∏—è**:
- ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç mobile_server.py (–µ—Å–ª–∏ –æ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - –ø–∞–¥–µ–Ω–∏–µ)
- ‚ö†Ô∏è –ü–æ—Ç–µ—Ä—è –≥–∏–±–∫–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏—è app —Å custom –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- ‚ö†Ô∏è –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞—Ç—å app –±–µ–∑ mobile_server

---

**1.2. `run_server_async()` —Ñ—É–Ω–∫—Ü–∏—è**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ (–Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π —Ä–µ–∂–∏–º)
- **–†–∞–∑–º–µ—Ä**: ~15 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **–ß—Ç–æ –¥–µ–ª–∞–ª–∞**:
  - –°–æ–∑–¥–∞–≤–∞–ª–∞ daemon thread –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞
  - –ó–∞–ø—É—Å–∫–∞–ª–∞ run_server() –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
  - –í–æ–∑–≤—Ä–∞—â–∞–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ä–∞–∑—É (–Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π –≤—ã–∑–æ–≤)

```python
# –ë—ã–ª–æ –≤ ca458ea:
def run_server_async(host: str = "127.0.0.1", port: int = 8001):
    """Run server in background thread (non-blocking)"""
    global server_thread

    def run():
        run_server(host, port)

    server_thread = threading.Thread(target=run, daemon=True)
    server_thread.start()

    logger.info(f"Backend started in background thread")

# –°—Ç–∞–ª–æ –≤ 324dd58:
# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∞
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —É–¥–∞–ª–µ–Ω–∏—è**:
- ‚ùå **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤ —Ñ–æ–Ω–µ
- ‚ùå Native –∫–æ–¥ (MainActivity.kt) –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å run_server –≤ –∫–æ—Ä—É—Ç–∏–Ω–µ
- ‚ùå –ë–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ native —Å–ª–æ–π

---

**1.3. `stop_server()` —Ñ—É–Ω–∫—Ü–∏—è**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- **–†–∞–∑–º–µ—Ä**: ~20 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **–ß—Ç–æ –¥–µ–ª–∞–ª–∞**:
  - –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∞ uvicorn server
  - –û—á–∏—â–∞–ª–∞ server_thread
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

```python
# –ë—ã–ª–æ –≤ ca458ea:
def stop_server():
    """Stop the running server"""
    global server, server_thread

    try:
        if server is not None:
            logger.info("Stopping server...")
            server.should_exit = True
            server = None

        if server_thread is not None:
            server_thread = None

        logger.info("Server stopped")

    except Exception as e:
        logger.error(f"Error stopping server: {e}")

# –°—Ç–∞–ª–æ –≤ 324dd58:
# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∞
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —É–¥–∞–ª–µ–Ω–∏—è**:
- ‚ùå **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï**: –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
- ‚ùå Native –∫–æ–¥ –Ω–µ –º–æ–∂–µ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Python backend
- ‚ùå –í–æ–∑–º–æ–∂–Ω—ã —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

---

**1.4. `initialize_database()` —Ñ—É–Ω–∫—Ü–∏—è**
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **–†–∞–∑–º–µ—Ä**: ~25 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- **–ß—Ç–æ –¥–µ–ª–∞–ª–∞**:
  - –°–æ–∑–¥–∞–≤–∞–ª–∞ —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  - –°–æ–∑–¥–∞–≤–∞–ª–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ë–î
  - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–∏–≥—Ä–∞—Ü–∏—è–º (TODO)

```python
# –ë—ã–ª–æ –≤ ca458ea:
def initialize_database():
    """Initialize SQLite database"""
    try:
        logger.info("Initializing database...")

        # Create database file if it doesn't exist
        db_file = Path(database_path)
        if not db_file.exists():
            db_file.parent.mkdir(parents=True, exist_ok=True)
            db_file.touch()
            logger.info(f"Created new database: {database_path}")

        # TODO: Run migrations when backend is integrated
        # from alembic.config import Config
        # from alembic import command
        # alembic_cfg = Config("alembic.ini")
        # command.upgrade(alembic_cfg, "head")

        logger.info("Database initialized")

    except Exception as e:
        logger.error(f"Database initialization failed: {e}")
        raise

# –°—Ç–∞–ª–æ –≤ 324dd58:
# –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∞
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —É–¥–∞–ª–µ–Ω–∏—è**:
- ‚ö†Ô∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ù–ï —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ö†Ô∏è –î–æ–ª–∂–Ω–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –≥–¥–µ-—Ç–æ –≤ mobile_server.py –∏–ª–∏ mobile_database.py
- ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

---

### 2. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ setup_environment()

#### –ë—ã–ª–æ (ca458ea):
```python
os.environ['DATABASE_URL'] = f'sqlite:///{db_path}'
os.environ['UPLOAD_DIR'] = upload_dir
os.environ['LOGS_DIR'] = logs_dir

# Mobile-specific settings
os.environ['ENVIRONMENT'] = 'mobile'
os.environ['DEBUG'] = 'false'
os.environ['CORS_ORIGINS'] = '*'

# Disable features not needed on mobile
os.environ['ENABLE_CELERY'] = 'false'
os.environ['ENABLE_REDIS'] = 'false'
os.environ['ENABLE_METRICS'] = 'false'
```

#### –°—Ç–∞–ª–æ (324dd58):
```python
os.environ['DATA20_DATABASE_PATH'] = db_path
os.environ['DATA20_UPLOAD_PATH'] = upload_dir
os.environ['DATA20_LOGS_PATH'] = logs_dir
os.environ['ENVIRONMENT'] = 'mobile'
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- ‚úÖ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞)
- ‚ùå –£–¥–∞–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: DEBUG, CORS_ORIGINS
- ‚ùå –£–¥–∞–ª–µ–Ω—ã —Ñ–ª–∞–≥–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è: ENABLE_CELERY, ENABLE_REDIS, ENABLE_METRICS

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è**:
- ‚ö†Ô∏è –ï—Å–ª–∏ mobile_server –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - –Ω–µ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ mobile_server —á–∏—Ç–∞–µ—Ç DATA20_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

---

### 3. –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–≤ 324dd58)

–ú–µ–∂–¥—É ca458ea –∏ 324dd58 –±—ã–ª–∏ **–¥–æ–±–∞–≤–ª–µ–Ω—ã**:

#### 3.1. –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –±—ç–∫–µ–Ω–¥–∞
- `mobile_server.py` (+427 —Å—Ç—Ä–æ–∫) - **–û—Å–Ω–æ–≤–Ω–æ–π FastAPI —Å–µ—Ä–≤–µ—Ä**
- `mobile_auth.py` (+157 —Å—Ç—Ä–æ–∫) - **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**
- `mobile_database.py` (+81 —Å—Ç—Ä–æ–∫) - **–†–∞–±–æ—Ç–∞ —Å –ë–î**
- `mobile_models.py` (+351 —Å—Ç—Ä–æ–∫) - **–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö**
- `mobile_tool_registry.py` (+489 —Å—Ç—Ä–æ–∫) - **–†–µ–µ—Å—Ç—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**
- `mobile_tool_runner.py` (+311 —Å—Ç—Ä–æ–∫) - **–ó–∞–ø—É—Å–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**

#### 3.2. –í—Å–µ 57 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ tools/*.py —Ñ–∞–π–ª—ã (—Å–º. –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤ git diff –≤—ã—à–µ)
- –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: ~50,000 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

#### 3.3. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- `copy-tools-to-python.sh` (+47 —Å—Ç—Ä–æ–∫) - **–°–∫—Ä–∏–ø—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**
- `.github/workflows/build-mobile-apk.yml` (+148 —Å—Ç—Ä–æ–∫) - **CI/CD –¥–ª—è —Å–±–æ—Ä–∫–∏ APK**
- `DOWNLOAD_APK.md` (+309 —Å—Ç—Ä–æ–∫) - **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã

### ‚úÖ –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
   - –ö–æ–¥ —Ä–∞–∑–±–∏—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ (mobile_server, mobile_auth –∏ —Ç.–¥.)
   - –õ–µ–≥—á–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
   - –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

2. **–í—Å–µ 57 –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω—ã**
   - –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
   - –ì–æ—Ç–æ–≤–æ –∫ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–µ

3. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**
   - DATA20_* –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ DATABASE_URL
   - –ë–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### ‚ùå –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–ü–û–¢–ï–†–ò):

1. **‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü–æ—Ç–µ—Ä—è `run_server_async()`**
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤ —Ñ–æ–Ω–µ –∏–∑ Python
   - Native –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –∫–æ—Ä—É—Ç–∏–Ω–∞–º–∏

2. **‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü–æ—Ç–µ—Ä—è `stop_server()`**
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
   - –í–æ–∑–º–æ–∂–Ω—ã —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏

3. **‚ùå –ü–æ—Ç–µ—Ä—è `create_mobile_app()`**
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç mobile_server.py
   - –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å app –±–µ–∑ –Ω–µ–≥–æ

4. **‚ùå –ü–æ—Ç–µ—Ä—è `initialize_database()`**
   - –ë–î –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ backend_main.py
   - –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ mobile_database.py

5. **‚ùå –ü–æ—Ç–µ—Ä—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**
   - –£–¥–∞–ª–µ–Ω—ã —Ñ–ª–∞–≥–∏ ENABLE_CELERY, ENABLE_REDIS, ENABLE_METRICS
   - –£–¥–∞–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ DEBUG, CORS_ORIGINS

---

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞: –ß—Ç–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å mobile_server.py

‚úÖ **–î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å**:
- [ ] FastAPI app —Å CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- [ ] Health check endpoint (`/health`)
- [ ] Root endpoint (`/`)
- [ ] –í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã (/auth, /tools, /jobs)
- [ ] Middleware –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å mobile_database.py

‚úÖ **–î–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å**:
- [ ] –§—É–Ω–∫—Ü–∏—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ë–î
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å MainActivity.kt / BackendBridge.swift

‚úÖ **–î–æ–ª–∂–µ–Ω –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
- [ ] –ó–∞–ø—É—Å–∫ run_server() –≤ –∫–æ—Ä—É—Ç–∏–Ω–µ/background thread
- [ ] –ú–µ—Ö–∞–Ω–∏–∑–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–ø—É—Å–∫–∞

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

–°–æ–∑–¥–∞—Ç—å **v5-full-with-async** –≤–µ—Ä—Å–∏—é –≥–¥–µ:
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `run_server_async()` –≤ backend_main.py
2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `stop_server()` –≤ backend_main.py
3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `initialize_database()` –≤ backend_main.py
4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Ñ–ª–∞–≥–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ö–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –≤ native –∫–æ–¥–µ

–û—Å—Ç–∞–≤–∏—Ç—å 324dd58 –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ:
1. –í MainActivity.kt –∑–∞–ø—É—Å–∫–∞—Ç—å run_server() –≤ CoroutineScope
2. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (process.destroy())
3. –í mobile_database.py –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ë–î

### –í–∞—Ä–∏–∞–Ω—Ç 3: –°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Å–æ—á–Ω–∏—Ü

1. **sandbox-ca458ea-original**: –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π ca458ea (—Å run_server_async)
2. **sandbox-324dd58-current**: –¢–µ–∫—É—â–∏–π 324dd58 (–±–µ–∑ async —Ñ—É–Ω–∫—Ü–∏–π)
3. **sandbox-hybrid**: –ì–∏–±—Ä–∏–¥ - mobile_server.py + run_server_async()
4. **sandbox-build-attempt-1**: –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å–±–æ—Ä–∫–∏
5. **sandbox-build-attempt-2**: –í—Ç–æ—Ä–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å–±–æ—Ä–∫–∏
6. –ò —Ç.–¥. –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–∏

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

1. **–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ mobile_server.py –±–µ–∑ run_server_async()?**
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–µ—Ç –ª–∏ native –∫–æ–¥ –∑–∞–ø—É—Å–∫–∞—Ç—å run_server()

2. **–°–æ–∑–¥–∞–µ—Ç—Å—è –ª–∏ –ë–î –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å mobile_database.py –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

3. **–ú–æ–∂–Ω–æ –ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä?**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ native –∫–æ–¥–µ

4. **–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ DATA20_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ?**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ mobile_server —á–∏—Ç–∞–µ—Ç –Ω–æ–≤—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

5. **–í—Å–µ –ª–∏ middleware –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã?**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CORS, logging, error handling

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | ca458ea | 324dd58 | –†–∞–∑–Ω–∏—Ü–∞ |
|-----------|---------|---------|---------|
| **backend_main.py** | ~250 —Å—Ç—Ä–æ–∫ | ~120 —Å—Ç—Ä–æ–∫ | **-130 —Å—Ç—Ä–æ–∫** |
| **–§—É–Ω–∫—Ü–∏–∏** | 5 —Ñ—É–Ω–∫—Ü–∏–π | 2 —Ñ—É–Ω–∫—Ü–∏–∏ | **-3 —Ñ—É–Ω–∫—Ü–∏–∏** |
| **–ú–æ–¥—É–ª–∏ –±—ç–∫–µ–Ω–¥–∞** | 0 –º–æ–¥—É–ª–µ–π | 6 –º–æ–¥—É–ª–µ–π | **+6 –º–æ–¥—É–ª–µ–π** |
| **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã** | 0 tools | 57 tools | **+57 tools** |
| **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä** | ~300 —Å—Ç—Ä–æ–∫ | ~55,700 —Å—Ç—Ä–æ–∫ | **+55,400 —Å—Ç—Ä–æ–∫** |

### –ü–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –ø–æ—Ç–µ—Ä—å:

| –ü–æ—Ç–µ—Ä—è | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ú–æ–∂–Ω–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä–æ–≤–∞—Ç—å? |
|--------|-------------|----------------------|
| `run_server_async()` | üî¥ –í—ã—Å–æ–∫–∞—è | ‚úÖ –î–∞ (–≤ native –∫–æ–¥–µ) |
| `stop_server()` | üî¥ –í—ã—Å–æ–∫–∞—è | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ |
| `create_mobile_app()` | üü° –°—Ä–µ–¥–Ω—è—è | ‚úÖ –î–∞ (–≤ mobile_server) |
| `initialize_database()` | üü° –°—Ä–µ–¥–Ω—è—è | ‚úÖ –î–∞ (–≤ mobile_database) |
| Config —Ñ–ª–∞–≥–∏ | üü¢ –ù–∏–∑–∫–∞—è | ‚úÖ –î–∞ (–≤ mobile_server) |

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–°–æ–∑–¥–∞—Ç—å —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç** ‚Üê DONE
2. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å mobile_server.py –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
3. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å mobile_database.py –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ë–î
4. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å MainActivity.kt –Ω–∞ background thread
5. ‚è≥ –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–µ—Å–æ—á–Ω–∏—Ü –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
6. ‚è≥ –†–∞–∑–¥–µ–ª–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Å–±–æ—Ä–∫–∏ –≤ –ø–µ—Å–æ—á–Ω–∏—Ü—ã
7. ‚è≥ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Å–æ—á–Ω–∏—Ü (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)

```
mobile-app-sandboxes/
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ original-ca458ea/          # –û—Ä–∏–≥–∏–Ω–∞–ª —Å run_server_async()
‚îú‚îÄ‚îÄ current-324dd58/           # –¢–µ–∫—É—â–∏–π –±–µ–∑ async —Ñ—É–Ω–∫—Ü–∏–π
‚îú‚îÄ‚îÄ hybrid-best-of-both/       # –ì–∏–±—Ä–∏–¥ –ª—É—á—à–µ–≥–æ –∏–∑ –æ–±–æ–∏—Ö
‚îú‚îÄ‚îÄ build-attempt-1/           # –ü–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ build-attempt-2/           # –í—Ç–æ—Ä–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ build-attempt-3/           # –ò —Ç.–¥.
‚îî‚îÄ‚îÄ experimental/              # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
    ‚îú‚îÄ‚îÄ experiment-1/
    ‚îú‚îÄ‚îÄ experiment-2/
    ‚îî‚îÄ‚îÄ ...
```

---

**–î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞**: 2026-01-05
**–ê–≤—Ç–æ—Ä**: Claude (–∞–Ω–∞–ª–∏–∑ git –∏—Å—Ç–æ—Ä–∏–∏)
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–µ—Ä–≤–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Å–æ—á–Ω–∏—Ü –∏ –¥–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
